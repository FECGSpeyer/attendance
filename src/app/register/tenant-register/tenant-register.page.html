<ion-header [translucent]="true">
  <ion-toolbar color="light">
    <ion-title>Registrierung</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content color="light" [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar color="light">
      <ion-title size="large">Registrierung</ion-title>
    </ion-toolbar>
  </ion-header>

  @if (tenantData) {
  <ion-card>
    <ion-card-header>
      <ion-icon class="headerIcon" name="business-outline"></ion-icon>
    </ion-card-header>
    <ion-card-content>
      <ion-title class="paddingTitle">{{ tenantData.longName }}</ion-title>
      <br>
      <p>Registriere dich über dieses Formular für die oben genannte Instanz.</p>
    </ion-card-content>
  </ion-card>

  <ion-list [inset]="true">
    <ion-list-header><ion-label>Persönliche Daten</ion-label></ion-list-header>
    <ion-item-group>
      <ion-item>
        <ion-label position="stacked">Vorname</ion-label>
        <ion-input [(ngModel)]="firstName" type="text" autocomplete="given-name"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Nachname</ion-label>
        <ion-input [(ngModel)]="lastName" type="text" autocomplete="family-name"></ion-input>
      </ion-item>
      <ion-item *ngIf="tenantData.registration_fields?.includes('birthDate')">
        <ion-label>Geburtsdatum</ion-label>
        <ion-datetime-button datetime="birthdateReg"></ion-datetime-button>
        <ion-modal [keepContentsMounted]="true">
          <ng-template>
            <ion-datetime [(ngModel)]="birthDate" presentation="date" id="birthdateReg" locale="de-DE"></ion-datetime>
          </ng-template>
        </ion-modal>
      </ion-item>
      <ion-item *ngIf="tenantData.registration_fields?.includes('phone')">
        <ion-label position="stacked">Handynummer</ion-label>
        <ion-input [(ngModel)]="phone" type="tel" autocomplete="tel"></ion-input>
      </ion-item>
    </ion-item-group>

    <ion-list-header><ion-label>Gruppe</ion-label></ion-list-header>
    <ion-item-group>
      <ion-item>
        <ion-select label="Gruppe" [(ngModel)]="selectedGroupId" #select>
          <ion-select-option [value]="group.id" *ngFor="let group of groups">{{ group.name }}</ion-select-option>
        </ion-select>
      </ion-item>
    </ion-item-group>

    <ion-list-header><ion-label>Account</ion-label></ion-list-header>
    @if (!db.user) {
    <ion-item-group>
      <ion-item button detail="false" (click)="login()">
        <ion-label color="primary">Account bereits vorhanden? Hier anmelden</ion-label>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">E-Mail Adresse</ion-label>
        <ion-input [(ngModel)]="email" type="email" autocomplete="email"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Passwort</ion-label>
        <ion-input [(ngModel)]="password" type="password" autocomplete="new-password"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Passwort bestätigen</ion-label>
        <ion-input [(ngModel)]="confirmPassword" type="password" autocomplete="new-password"></ion-input>
      </ion-item>
    </ion-item-group>
    } @else {
    <ion-item-group>
      <ion-item>
        <ion-label>Du bist angemeldet als {{ db.user.email }}.</ion-label>
      </ion-item>
    </ion-item-group>
    }

    <ion-item-group>
      <ion-item (click)="register()" button detail="false">
        <ion-label color="primary">Registrieren abschließen</ion-label>
      </ion-item>
    </ion-item-group>
  </ion-list>
  }
</ion-content>