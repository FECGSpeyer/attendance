<ion-header translucent="true">
  <ion-toolbar>
    <ion-title>Mehr</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Mehr</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-list>
    <ion-list-header sticky="true">
      Orchester
    </ion-list-header>
    <ion-item routerLink="songs" button>
      <ion-label>Werke</ion-label>
    </ion-item>
    <ion-item button (click)="openHistoryModal()">
      <ion-label>Werkhistorie</ion-label>
    </ion-item>
    <ion-item routerLink="meetings" button>
      <ion-label>Besprechungen</ion-label>
    </ion-item>
    <ion-item routerLink="instruments" button>
      <ion-label>Instrumente</ion-label>
    </ion-item>
    <ion-item routerLink="teachers" *ngIf="showTeachers" button>
      <ion-label>Lehrer</ion-label>
    </ion-item>
    <ion-item button (click)="openPlanning()">
      <ion-label>Probenplan erstellen</ion-label>
    </ion-item>
    <ion-item detail="false" button id="trigger-button">
      <ion-label>Registerprobenplan erstellen</ion-label>
      <ion-modal trigger="trigger-button" [breakpoints]="[0.5]" [initialBreakpoint]="0.5">
        <ng-template>
          <ion-content>
            <ion-header>
              <ion-toolbar>
                <ion-title>Plan erstellen</ion-title>
              </ion-toolbar>
            </ion-header>
            <ion-item>
              <ion-label position="stacked">Dirigenten</ion-label>
              <ion-select [(ngModel)]="selConductors" #select multiple="true">
                <ion-select-option [value]="con.id" *ngFor="let con of conductors">{{ con.firstName }} {{ con.lastName }}</ion-select-option>
              </ion-select>
            </ion-item>
            <ion-item>
              <ion-label position="stacked">Zeit in Minuten</ion-label>
              <ion-input value="60" #input type="number"></ion-input>
            </ion-item>
            <ion-button [disabled]="!select.value?.length || !input.value" (click)="createPlan(select.value, input.value)" expand="block">Erstellen</ion-button>
          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-item>

    <ion-item *ngIf="leftPlayers?.length" detail="false" button id="archive-button">
      <ion-label>Archiv</ion-label>
      <ion-modal trigger="archive-button" [breakpoints]="[0.5, 1]" [initialBreakpoint]="0.5">
        <ng-template>
          <ion-content>
            <ion-header>
              <ion-toolbar>
                <ion-title>Archiv</ion-title>
              </ion-toolbar>
            </ion-header>
            <ion-list>
              <ion-list-header>Dirigenten</ion-list-header>
              <ion-item button (click)="openPlayerModal(p, true)" *ngFor="let p of leftConductors">
                <ion-label>
                  <h2>{{ p.firstName }} {{ p.lastName }}</h2>
                  <h3>Ausgetreten: {{ p.left | date:"dd.MM.YYYY" }}</h3>
                </ion-label>
              </ion-item>
            </ion-list>
            <ion-list>
              <ion-list-header>Spieler</ion-list-header>
              <ion-item button (click)="openPlayerModal(p)" *ngFor="let p of leftPlayers">
                <ion-label>
                  <h2>{{ p.firstName }} {{ p.lastName }} ({{ p.instrumentName }})</h2>
                  <h3>Ausgetreten: {{ p.left | date:"dd.MM.YYYY" }}</h3>
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-item>

    <ion-item button *ngIf="playersWithoutAccount.length" (click)="createAccounts()" color="primary">
      <ion-label>Fehlende Benutzeraccounts anlegen</ion-label>
    </ion-item>

    <ion-list-header sticky="true">
      Allgemein
    </ion-list-header>
    <ion-item button (click)="openStats()">
      <ion-label>Statistiken</ion-label>
    </ion-item>

    <ion-item button (click)="openExport()">
      <ion-label>Export</ion-label>
    </ion-item>

    <ion-item button detail="false" id="whatsnew-button">
      <ion-label>Version</ion-label>
      <ion-badge slot="end">{{ version }}</ion-badge>
      <ion-modal trigger="whatsnew-button" [breakpoints]="[0.5, 1]" [initialBreakpoint]="0.5">
        <ng-template>
          <ion-content>
            <ion-header>
              <ion-toolbar>
                <ion-title>What's new</ion-title>
              </ion-toolbar>
            </ion-header>

            <ion-list>
              <ion-list-header>Version 1.4.2</ion-list-header>
              <ion-item>
                <ion-label>
                  <h2>- Probenplan zu Anwesenheit zuteilbar</h2>
                  <h2>- Pull to refresh für Anwesenheit und Spieler eingebaut</h2>
                  <h2>- Fehlerbehebung: Aktuelle Anwesenheit löschbar</h2>
                </ion-label>
              </ion-item>
              <ion-list-header>Version 1.4.1</ion-list-header>
              <ion-item>
                <ion-label>
                  <h2>- Datumsauswahl schließt automatisch</h2>
                  <h2>- Email Template angepasst</h2>
                  <h2>- Fehlerbehebung: Instrumente nicht editierbar</h2>
                </ion-label>
              </ion-item>
              <ion-list-header>Version 1.4.0</ion-list-header>
              <ion-item>
                <ion-label>
                  <h2>- Probenplanung hinzugefügt</h2>
                  <h2>- Werk aus Historie löschbar</h2>
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-content>
        </ng-template>
      </ion-modal>
    </ion-item>
    <ion-item color="danger" button (click)="logout()">
      <ion-label>Ausloggen</ion-label>
    </ion-item>
  </ion-list>
</ion-content>
